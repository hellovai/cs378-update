% size iterations density threads err time err time
data = [[4  200 0.6 1 0.1742  2.6e-05 0.1742  2e-06],
[4  200 0.7 1 0.1742  1.5e-05 0.1742  1e-06],
[4  200 0.8 1 0.1742  1.5e-05 0.1742  1e-06],
[4  200 0.9 1 0.135 1.6e-05 0.135 1e-06],
[4  200 1 1 0.09399 3.2e-05 0.09399 2e-06],
[4  200 0.6 2 0.1742  0.000186  inf 3e-05],
[4  200 0.7 2 0.1742  0.00033 inf 4.2e-05],
[4  200 0.8 2 0.1742  0.000144  3.328e+05 2.5e-05],
[4  200 0.9 2 0.135 0.000101  0.135 2.1e-05],
[4  200 1 2 0.09399 5.9e-05 0.09399 5.6e-05],
[4  200 0.6 4 0.1742  0.00016 inf 5.9e-05],
[4  200 0.7 4 0.1742  0.000111  inf 2.9e-05],
[4  200 0.8 4 0.1742  0.00016 0.1742  3.7e-05],
[4  200 0.9 4 0.135 0.000128  0.135 6.4e-05],
[4  200 1 4 0.09399 0.000179  3.71e+15  3.1e-05],
[4  200 0.6 8 0.1742  0.000178  1.011e+15 8.8e-05],
[4  200 0.7 8 0.1742  0.000225  inf 0.000136],
[4  200 0.8 8 0.1742  0.000157  inf 9.1e-05],
[4  200 0.9 8 0.135 0.00019 0.135 5.2e-05],
[4  200 1 8 0.09399 0.000214  inf 0.000169],
[4  200 0.6 16  0.1742  0.000359  0.1742  0.000153],
[4  200 0.7 16  0.1742  0.000434  0.1742  0.000217],
[4  200 0.8 16  0.1742  0.000405  9.42e+05  9.3e-05],
[4  200 0.9 16  0.135 0.000358  0.135 0.000245],
[4  200 1 16  0.09399 0.000492  0.09399 0.000199],
[4  200 0.6 32  0.1742  0.009448  2.023e+15 0.000711],
[4  200 0.7 32  0.1742  0.001019  inf 0.000521],
[4  200 0.8 32  0.1742  0.001115  0.1742  0.000421],
[4  200 0.9 32  0.135 0.000656  1.419e+07 0.000476],
[4  200 1 32  0.09399 0.000852  0.09399 0.000311],
[40 200 0.6 1 0.006497  2.2e-05 0.006497  7e-06],
[40 200 0.7 1 0.007717  2.2e-05 0.007717  7e-06],
[40 200 0.8 1 0.006753  2e-05 0.006753  7e-06],
[40 200 0.9 1 0.008966  2.1e-05 0.008966  7e-06],
[40 200 1 1 0.009859  2.1e-05 0.009859  7e-06],
[40 200 0.6 2 0.006497  8.1e-05 2.283e+04 3.9e-05],
[40 200 0.7 2 0.007717  7.1e-05 0.007713  3.6e-05],
[40 200 0.8 2 0.006753  0.00011 0.006753  2.5e-05],
[40 200 0.9 2 0.008966  9.5e-05 inf 3.1e-05],
[40 200 1 2 0.009859  6.8e-05 0.009859  5.7e-05],
[40 200 0.6 4 0.006497  0.000131  0.006497  4.7e-05],
[40 200 0.7 4 0.007717  0.000131  inf 4.5e-05],
[40 200 0.8 4 0.006753  0.000122  0.006753  3.3e-05],
[40 200 0.9 4 0.008966  0.000146  inf 4.1e-05],
[40 200 1 4 0.009859  0.000126  inf 5.6e-05],
[40 200 0.6 8 0.006497  0.000184  0.006497  0.000111],
[40 200 0.7 8 0.007717  0.000235  inf 9.7e-05],
[40 200 0.8 8 0.006753  0.000176  inf 0.000108],
[40 200 0.9 8 0.008966  0.000204  1.267e+14 0.000114],
[40 200 1 8 0.009859  0.000194  14.71 0.000104],
[40 200 0.6 16  0.006497  0.000354  0.006497  0.000187],
[40 200 0.7 16  0.007717  0.000494  inf 0.000234],
[40 200 0.8 16  0.006753  0.000447  3.797 0.000239],
[40 200 0.9 16  0.008966  0.000328  4.167e+15 0.000271],
[40 200 1 16  0.009859  0.000395  0.009859  0.000144],
[40 200 0.6 32  0.006497  0.000855  0.006497  0.000618],
[40 200 0.7 32  0.007717  0.00061 0.007717  0.000546],
[40 200 0.8 32  0.006753  0.000754  0.006753  0.000531],
[40 200 0.9 32  0.008966  0.000832  0.008966  0.000452],
[40 200 1 32  0.009859  0.000933  inf 0.000469],
[400  200 0.6 1 0.0006576 0.000664  0.0006576 0.000481],
[400  200 0.7 1 0.0007025 0.000662  0.0007025 0.000484],
[400  200 0.8 1 0.0006852 0.000664  0.0006852 0.000487],
[400  200 0.9 1 0.0008635 0.000741  0.0008635 0.000533],
[400  200 1 1 0.0008884 0.000782  0.0008884 0.000486],
[400  200 0.6 2 0.0006576 0.00041 0.0006576 0.000297],
[400  200 0.7 2 0.0007025 0.000608  0.0007025 0.000375],
[400  200 0.8 2 0.0006852 0.000433  inf 0.000284],
[400  200 0.9 2 0.0008635 0.000465  0.0008635 0.000344],
[400  200 1 2 0.0008884 0.000686  0.0008883 0.0003],
[400  200 0.6 4 0.0006576 0.00051 5.883e+14 0.000319],
[400  200 0.7 4 0.0007025 0.000471  inf 0.000269],
[400  200 0.8 4 0.0006852 0.000582  inf 0.000281],
[400  200 0.9 4 0.0008635 0.000466  0.0008635 0.000278],
[400  200 1 4 0.0008884 0.000501  1.797e+10 0.000269],
[400  200 0.6 8 0.0006576 0.000627  0.2822  0.000416],
[400  200 0.7 8 0.0007025 0.000541  0.0007025 0.000297],
[400  200 0.8 8 0.0006852 0.000729  inf 0.00031],
[400  200 0.9 8 0.0008635 0.000553  0.0008635 0.000294],
[400  200 1 8 0.0008884 0.000571  0.0008884 0.000306],
[400  200 0.6 16  0.0006576 0.000729  0.0006576 0.000459],
[400  200 0.7 16  0.0007025 0.000671  inf 0.000312],
[400  200 0.8 16  0.0006852 0.000684  0.0006852 0.000448],
[400  200 0.9 16  0.0008635 0.000744  0.0008667 0.00043],
[400  200 1 16  0.0008884 0.000804  2.007e+10 0.000384],
[400  200 0.6 32  0.0006576 0.001285  0.0006576 0.000664],
[400  200 0.7 32  0.0007025 0.001031  inf 0.000641],
[400  200 0.8 32  0.0006852 0.001027  0.0007139 0.000511],
[400  200 0.9 32  0.0008635 0.001144  3.335e+14 0.000527],
[400  200 1 32  0.0008884 0.001246  1.378e+09 0.000704],
[4000 200 0.6 1 6.643e-05 0.1844  6.643e-05 0.07622],
[4000 200 0.7 1 6.992e-05 0.2047  6.992e-05 0.07513],
[4000 200 0.8 1 7.417e-05 0.2039  7.417e-05 0.07249],
[4000 200 0.9 1 7.943e-05 0.1793  7.943e-05 0.07024],
[4000 200 1 1 8.3e-05 0.1922  8.3e-05 0.08179],
[4000 200 0.6 2 6.643e-05 0.09208 0.07269 0.03725],
[4000 200 0.7 2 6.992e-05 0.1246  4.653 0.03946],
[4000 200 0.8 2 7.417e-05 0.09366 7.567e+13 0.03587],
[4000 200 0.9 2 7.943e-05 0.08932 7.943e-05 0.035],
[4000 200 1 2 8.3e-05 0.1282  8.3e-05 0.06424],
[4000 200 0.6 4 6.643e-05 0.09343 6.643e-05 0.03757],
[4000 200 0.7 4 6.992e-05 0.09209 6.992e-05 0.03796],
[4000 200 0.8 4 7.417e-05 0.12  2.506e+13 0.03752],
[4000 200 0.9 4 7.943e-05 0.09331 2.005e+14 0.03801],
[4000 200 1 4 8.3e-05 0.09892 inf 0.0449],
[4000 200 0.6 8 6.643e-05 0.1164  inf 0.05285],
[4000 200 0.7 8 6.992e-05 0.1061  6.992e-05 0.04296],
[4000 200 0.8 8 7.417e-05 0.09474 inf 0.04485],
[4000 200 0.9 8 7.943e-05 0.09319 inf 0.03923],
[4000 200 1 8 8.3e-05 0.09258 1.423 0.03921],
[4000 200 0.6 16  6.643e-05 0.1007  6.643e-05 0.03994],
[4000 200 0.7 16  6.992e-05 0.1108  6.992e-05 0.03788],
[4000 200 0.8 16  7.417e-05 0.09877 7.417e-05 0.04498],
[4000 200 0.9 16  7.943e-05 0.1692  7.943e-05 0.04095],
[4000 200 1 16  8.3e-05 0.09563 inf 0.03809],
[4000 200 0.6 32  6.643e-05 0.09495 6.643e-05 0.06456],
[4000 200 0.7 32  6.992e-05 0.09262 6.992e-05 0.03776],
[4000 200 0.8 32  7.417e-05 0.09364 7.417e-05 0.03786],
[4000 200 0.9 32  7.943e-05 0.09095 0.1012  0.0393],
[4000 200 1 32  8.3e-05 0.1122  8.3e-05 0.03888]];

% fixed density (0.7)
rd = (data(:,3) == 0.7);
colors = ['r' 'b' 'g' 'k' 'y' 'm'];
threads = [1 2 4 8 16 32];

figure;
hold on;
for i=1:length(threads)
  rdx = (data(:, 4) == threads(i)) & rd;
  y = data(rdx, 1); % matrix size
  % Scalar
  z = data(rdx, 6); % time taken
  plot(y, z, colors(i));
end
hold off;
legend('1 Thread', '2 Thread', '4 Thread', '8 Thread', '16 Thread', '32 Thread');
xlabel('Matrix N x N');
ylabel('Time Taken');
title('Scalar Solution - Matrix 70% dense');

figure;
hold on;
for i=1:length(threads)
  rdx = (data(:, 4) == threads(i)) & rd;
  y = data(rdx, 1); % matrix size
  % Vectorized
  z = data(rdx, 8); % time taken
  plot(y, z, colors(i));
end
hold off;
legend('1 Thread', '2 Thread', '4 Thread', '8 Thread', '16 Thread', '32 Thread');
xlabel('Matrix N x N');
ylabel('Time Taken');
title('Vectorized Solution - Matrix 70% dense');

% Fixed Threads (4) vary density
rd = (data(:,4) == 4);
density = 0.6:0.1:1.0;

figure;
hold on;
for i=1:length(density)
  rdx = (data(:, 3) == density(i)) & rd;
  y = data(rdx, 1); % matrix size
  % Scalar
  z = data(rdx, 6); % time taken
  plot(y, z, colors(i));
end
hold off;
legend('0.6 dense', '0.7 dense', '0.8 dense', '0.9 dense', '1.0 dense');
xlabel('Matrix N x N');
ylabel('Time Taken');
title('Scalar Solution - 4 threads');

figure;
hold on;
for i=1:length(density)
  rdx = (data(:, 3) == density(i)) & rd;
  y = data(rdx, 1); % matrix size
  % Scalar
  z = data(rdx, 8); % time taken
  plot(y, z, colors(i));
end
hold off;
legend('0.6 dense', '0.7 dense', '0.8 dense', '0.9 dense', '1.0 dense');
xlabel('Matrix N x N');
ylabel('Time Taken');
title('Vectorized Solution - Matrix 70% dense');
